<% javascript_include 'search_term_context' -%>

<p>
  '<%= h @q -%>' appears in <%= link_to pluralize(@podcast_groups.count(Podcast), 'podcast title'), search_url(:q => "#{h @parsed_q} only:podcasts") %>, 
                          <%= link_to pluralize(@podcast_groups.count(Feed) , "feed address"), search_url(:q => "#{h @parsed_q} only:feeds") %>,
                          <%= link_to pluralize(@podcast_groups.count(Episode), "episodes"), search_url(:q => "#{h @parsed_q} only:episodes") %>, and
                          <%= link_to pluralize(@podcast_groups.count(Review), "reviews"), search_url(:q => "#{h @parsed_q} only:reviews") %>.
</p>

<%= "<p>Tag #{link_to @tag.name, tag_url(:tag => @tag)}</p>" if @tag %>

<%= "<p>User #{link_to_profile @user}</p>" if @user -%>

<% unless @podcast_groups.blank? -%>
<ul class="podcast_results">
  <% @podcast_groups.each_pair do |id, objs| -%>
    <% if podcast = @podcasts.find { |p| p.id == id } -%>
    <li>
      <p>
        <%= link_to_podcast podcast -%> <%=  %>
        <span class="searched"><%= podcast.description -%></span>
      </p>
      
      <ul>
        <% (@podcast ? objs : objs[0..2]).each do |o| -%>
          <%= render :partial => o.class.to_s.downcase, :object => o unless o.is_a?(Podcast) %>
        <% end -%>
      </ul>
  
      <% if !@podcast && objs.size > 3 -%>
      <p>More results from <%= link_to "#{podcast.title}&hellip;", search_url(:q => @q, :podcast => podcast) %></p>
      <% end -%>
    </li>
    <% end -%>
  <% end -%>
</ul>

<%= will_paginate @podcasts %>

<% end -%>

