<% @title = h(@user.login) -%>
<% @classes = %{podcast index show} -%>
<% @show_ads = true if @user.reviews.count > 0 -%>
<% javascript_include "review_edit", "review_delete", "podcast_edit" -%>

<script type="text/javascript">
  $().ready(function() {  
    $('.description > p').jTruncate({  
      length: 120,  
    });  
  });
</script>

 
<%= render :partial => 'users/edit' if current_user && (current_user == @user || current_user.admin?) %>
<%= render :partial => 'users/claim' if !current_user && @user.passive? -%>

<h1><%=h @user.login -%><%= "" unless @user.podcaster? %>'s profile</h1>


<div id="member_profile" class="tabify main">
  <ul>
    <% if @user.favorite_podcasts.size > 0 -%>
      <li><a href="#profile_favorites"><h4>Favorites <span>(<%= @user.favorite_podcasts.size %>)</span></h4></a></li>
    <% end -%>
    <% if @user.podcasts.size > 0 -%>
      <li><a href="#profile_found"><h4>Found <span>(<%= @user.podcasts.size %>)</span></h4></a></li>
    <% end -%>
    <% if @user.owned_podcasts.count > 0 -%>
      <li><a href="#profile_owned"><h4>Owned</h4></a></li>
    <% end -%>
    <% if @user.reviews.count > 0 -%>
      <li><a href="#profile_reviews"><h4>Reviews <span>(<%= @user.reviews.count %>)</span></h4></a></li>
    <% end -%>
  </ul>

  <% if @user.favorite_podcasts.size > 0 -%>
    <div id="profile_favorites" class="rounded_corners">
      <% rounded_corners do -%>
        <ul class="podcasts clearfix">
          <%= render :partial => 'podcasts/podcast', :collection => @user.favorite_podcasts, :locals => {:user => @user, :favorite_link => true} -%>
        </ul>
      <% end -%>
    </div>
  <% end -%>
  
  <% if @user.podcasts.size > 0 -%>
    <div id="profile_found" class="rounded_corners">
      <% rounded_corners do -%>
        <ul class="podcasts clearfix">
          <%= render :partial => 'podcasts/podcast', :collection => @user.podcasts -%>
        </ul>
      <% end -%>
    </div>
  <% end -%>
  
  <% if @user.owned_podcasts.count > 0 -%>
    <div id="profile_owned" class="rounded_corners">
      <% rounded_corners do -%>
        <ul class="podcasts clearfix">
          <%= render :partial => 'podcasts/podcast', :collection => @user.owned_podcasts -%>
        </ul>
      <% end -%>
    </div>
  <% end -%>
  
  <% if @user.reviews.count > 0 -%>
    <div id="profile_reviews" class="rounded_corners">
      <% rounded_corners do -%>
        <h2>Reviewed</h2>
        <ul class="reviews clearfix">
          <%= render :partial => 'reviews/review', :collection => @user.reviews, :locals => {:with_podcast_reference => true} -%>
        </ul>
      <% end -%>
    </div>
  <% end -%>

</div> <!--/memeber_profile-->

<div id="profile_goog">
  <%= google_ads -%>
</div>

